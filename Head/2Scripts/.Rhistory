cor.test(MamTemper$Temp,MamTemper$A_C, method = 'spearman') #  a bit negative
cor.test(MamTemper$Temp,MamTemper$T_A, method = 'spearman')
cor.test(MamTemper$Temp,MamTemper$T_G, method = 'spearman')
cor.test(MamTemper$Temp,MamTemper$T_C, method = 'spearman')
cor.test(MamTemper$Temp,MamTemper$G_A, method = 'spearman')
cor.test(MamTemper$Temp,MamTemper$G_T, method = 'spearman')
cor.test(MamTemper$Temp,MamTemper$G_C, method = 'spearman')
cor.test(MamTemper$Temp,MamTemper$C_A, method = 'spearman')
cor.test(MamTemper$Temp,MamTemper$C_T, method = 'spearman')
cor.test(MamTemper$Temp,MamTemper$C_G, method = 'spearman')
#########
#### MAMMALS: HIBERNATION  ~ NOTHING
#########
Hib = read.table('../../Body/1Raw/HibernatingMammals.txt', sep = '\t')
names(Hib) = c('Species')
Hib$Species = gsub(' ','_',Hib$Species)
MamGt$G_A.NoEffectOfGFreq = MamGt$G_A / (MamGt$G_A + MamGt$G_T + MamGt$G_C); summary(MamGt$G_A.NoEffectOfGFreq)
nrow(MamGt[MamGt$Species %in% Hib$Species,]) # N = 35
MamGt = MamGt[MamGt$G_A.NoEffectOfGFreq < 1,]
wilcox.test(MamGt[MamGt$Species %in% Hib$Species,]$G_A.NoEffectOfGFreq,MamGt[!MamGt$Species %in% Hib$Species,]$G_A.NoEffectOfGFreq, alternative = 'less')
MamGtTemper = merge(MamGt,Temper) # 78
a<-lm(MamGtTemper$G_A ~ MamGtTemper$GenerationLength_d*MamGtTemper$Temp); summary(a)
#########
#### MAMMALS: BMR from AN AGE
#########
AnAge = read.table('../../Body/1Raw/anage_data.txt', sep = '\t', header = TRUE)
AnAge$Species = paste(AnAge$Genus,AnAge$Species,sep = '_')
AnAgeMammals = AnAge[AnAge$Class == 'Mammalia',]
AnAgeMammals = merge(MUT,AnAgeMammals)
cor.test(AnAgeMammals$G_A,AnAgeMammals$Temperature..K., method = 'spearman')
cor.test(AnAgeMammals$G_A,AnAgeMammals$Metabolic.rate..W., method = 'spearman') # a bit negative
cor.test(AnAgeMammals$A_G,AnAgeMammals$Metabolic.rate..W., method = 'spearman') #
cor.test(AnAgeMammals$T_C,AnAgeMammals$Metabolic.rate..W., method = 'spearman') # a bit positive
cor.test(AnAgeMammals$G_A,AnAgeMammals$Body.mass..g., method = 'spearman') # a bit negative!
#########
#### MAMMALS: PRCOMP
#########
MUT = read.table('../../Body/3Results/VertebratePolymorphisms.MutSpecData.OnlyFourFoldDegCytb.txt', header = TRUE) # OnlyFourFoldDegCytb
MUT$TsTv = (MUT$T_C + MUT$C_T + MUT$G_A + MUT$A_G) / (MUT$T_A + MUT$A_T + MUT$G_C + MUT$C_G + MUT$G_T + MUT$T_G + MUT$C_A + MUT$A_C)
MUT = MUT[MUT$TsTv < Inf,]
GT = read.table('../../Body/1Raw/GenerationLenghtforMammals.xlsx.txt', sep = '\t', header = TRUE)
GT$Species = gsub(' ','_',GT$Scientific_name)
MamGt = merge(GT,MUT, by = 'Species') # 426
Qual = data.frame(table(MamGt$Species))
UniqueSpecies = Qual[Qual$Freq == 1,]$Var1; length(UniqueSpecies);
MamGt = MamGt[MamGt$Species %in% UniqueSpecies,]
######## add the number of mutations per species
Number = read.table('../../Body/3Results/VertebratePolymorphisms.MutSpecData.txt')
Number = data.frame(Number$Species,Number$NumOfFourFoldMutInCytB); names(Number)=c('Species','NumOfFourFoldMutInCytB')
Number = unique(Number) # 2118
nrow(MamGt) # 424
MamGt = merge(MamGt,Number, by ='Species')
nrow(MamGt) # 424
###### PCA
names(MamGt)
MATRIX = MamGt[,c(14:25)]
row.names(MATRIX)=MamGt$Species
matrix = MATRIX
PCA = prcomp(matrix, center = TRUE, scale = TRUE) #FALSE) # I don't scale because we analyze the same units (fraction from MutSpec)
print(PCA)
summary(PCA)
MATRIX$Pca1 = PCA$x[,1]
MATRIX$Pca2 = PCA$x[,2]
MATRIX$Pca3 = PCA$x[,3]
MATRIX$Pca4 = PCA$x[,4]
MATRIX = cbind(MATRIX,MamGt[,c(1:14,26,27)])
###### ANALYSIS OF COMPONENTS
plot(log2(MATRIX$GenerationLength_d),MATRIX$Pca2)
cor.test(MATRIX$Pca1,MATRIX$GenerationLength_d, method = 'spearman') # rho = 0.004288973, p = 0.9298
cor.test(MATRIX$Pca2,MATRIX$GenerationLength_d, method = 'spearman') # rho = -0.3897472, p =  < 2.2e-16
cor.test(MATRIX$Pca3,MATRIX$GenerationLength_d, method = 'spearman') # rho = -0.1037697, p =  0.03266
cor.test(MATRIX$Pca1,MATRIX$NumOfFourFoldMutInCytB, method = 'spearman') # rho = -0.02800981, p = 0.5652
cor.test(MATRIX$Pca2,MATRIX$NumOfFourFoldMutInCytB, method = 'spearman') # rho = 0.2247093, p = 2.964e-06 PAPER
a<-lm(MATRIX$Pca2 ~ scale(MATRIX$GenerationLength_d) + scale(MATRIX$NumOfFourFoldMutInCytB)); summary(a)  # PAPER
a<-lm(MATRIX$Pca2 ~ scale(MATRIX$GenerationLength_d)*scale(MATRIX$NumOfFourFoldMutInCytB)); summary(a)    # PAPER
biplot(PCA, choices=c(1,2), col = c('white','black'), cex = 0.8) #  biplot(princomp(USArrests),choices=c(1,3))
MATRIX$SIZE = (log10(MATRIX$GenerationLength_d) - min(log10(MATRIX$GenerationLength_d))) / (max(log10(MATRIX$GenerationLength_d))   - min(log10(MATRIX$GenerationLength_d)))  #  normilaze data to 0-1 range
summary(MATRIX$SIZE)
plot(MATRIX$Pca1,MATRIX$Pca2, pch = 16, cex = 1.5, col = rgb(MATRIX$SIZE,0,0,1))
plot(MATRIX$Pca1,MATRIX$Pca2, pch = 16, cex = 1.5, col = rgb(0,MATRIX$SIZE,0,1), xlim = c(-11,3), ylim = c(-3,4.5));
biplot(PCA, choices=c(1,2), scale = 0.5, col = c('grey','black'), cex = 0.5) # , xlim = c(-11,3), ylim = c(-3,4.5))
summary(MATRIX$Pca1)
summary(PCA$x[,1])
# arrows(0,0,0.50722224,0.078411901, col = 'red', lwd = 2)
biplot(PCA, choices=c(1,2), scale = 1, col = c('grey','black'), cex = 0.5)
plot(MATRIX$Pca1,MATRIX$Pca2, pch = 16, cex = 1.5, col = rgb(0,0,MATRIX$SIZE,1))
plot(PCA$x[,1],PCA$x[,2])
PCA$x # PC's
PCA$sdev # the eigenvalues (res$sdev) giving information on the magnitude of each PC,
PCA$rotation # and the loadings (res$rotation).
dev.off()
library(gridExtra) # install.packages("gridExtra")
install.packages("gridExtra")
library(gridExtra) # install.packages("gridExtra")
library(grid)
############ Syn mut
unzip("../../Body/3Results/AllGenesCodonUsageNoOverlap.txt.zip", exdir = "../../Body/3Results/")
SynNuc = read.table("../../Body/3Results/AllGenesCodonUsageNoOverlap.txt", header = TRUE, sep = '\t')
if (file.exists("../../Body/3Results/AllGenesCodonUsageNoOverlap.txt")) file.remove("../../Body/3Results/AllGenesCodonUsageNoOverlap.txt")
names(SynNuc)
### make ND6 complementary:
NotND6 = SynNuc[SynNuc$Gene != 'ND6',]
ND6 = SynNuc[SynNuc$Gene == 'ND6',]
A = ND6$NeutralT
T = ND6$NeutralA
G = ND6$NeutralC
C = ND6$NeutralG
ND6$NeutralA = A
ND6$NeutralT = T
ND6$NeutralG = G
ND6$NeutralC = C
SynNuc = rbind(NotND6,ND6)
SynNuc$FrA = SynNuc$NeutralA / (SynNuc$NeutralA + SynNuc$NeutralT + SynNuc$NeutralG + SynNuc$NeutralC)
SynNuc$FrT = SynNuc$NeutralT / (SynNuc$NeutralA + SynNuc$NeutralT + SynNuc$NeutralG + SynNuc$NeutralC)
SynNuc$FrG = SynNuc$NeutralG / (SynNuc$NeutralA + SynNuc$NeutralT + SynNuc$NeutralG + SynNuc$NeutralC)
SynNuc$FrC = SynNuc$NeutralC / (SynNuc$NeutralA + SynNuc$NeutralT + SynNuc$NeutralG + SynNuc$NeutralC)
SynNuc$TAXON = SynNuc$Class
VecOfTaxa = unique(SynNuc$TAXON)
############# GENERATION LENGTH FOR ALL MAMMALS
GT = read.table("../../Body/1Raw/GenerationLenghtforMammals.xlsx.txt", header = TRUE, sep = '\t')
GT$Species = gsub(' ','_',GT$Scientific_name)
length(unique(GT$Species))
summary(GT$AdultBodyMass_g)     # 2        21        71    136058       614 154321304
summary(GT$GenerationLength_d)  # 129.0   624.4  1101.1  1578.8  2064.3 18980.0 # max = 18980 days => 52 years. ok
GT = GT[,c(11,13)]
summary(GT$GenerationLength_d)
############ merge (work only with mammals since GT is only for mammals)
SynNucGT = merge(GT,SynNuc)
length(unique(SynNucGT$Species))  # 649 species
table(SynNucGT$TAXON)
############ data for PICs
library(ape)
tree <- read.tree("../../Body/1Raw/mtalign.aln.treefile.rooted")
data = SynNucGT[which(as.character(SynNucGT$Species) %in% tree$tip.label),]
df_vec <- as.character(SynNucGT$Species)
tree_vec <- tree$tip.label
a <- setdiff(df_vec, tree_vec)
b <- setdiff(tree_vec, df_vec)
row.names(data) = data$Species
tree2 <- drop.tip(tree, b)
TempData = data[, -c(1, 5)]
View(TempData)
contrasts <- as.data.frame(apply(TempData, 2, pic, tree2))
########### question 1: which nucleotides better correlate with GT: log2(GT) = 11 - 0.29*scale(FrT) + 0.33*scale(FrC) (in line with our mutational spectrum result that T->C correlates with generation time)
AGG = aggregate(list(SynNucGT$FrA,SynNucGT$FrT,SynNucGT$FrG,SynNucGT$FrC), by = list(SynNucGT$Species,SynNucGT$GenerationLength_d), FUN = mean)
names(AGG) = c('Species','GenerationLength_d','FrA','FrT','FrG','FrC')
tree <- read.tree("../../Body/1Raw/mtalign.aln.treefile.rooted")
data = AGG[which(as.character(AGG$Species) %in% tree$tip.label),]
data$GenerationLength_d = log2(data$GenerationLength_d)  # I added log of generation length
df_vec <- as.character(AGG$Species)
tree_vec <- tree$tip.label
a <- setdiff(df_vec, tree_vec)
b <- setdiff(tree_vec, df_vec)
data = data[-597,] # is it duplicate!!!???
row.names(data) = data$Species
tree2 <- drop.tip(tree, b)
TempData = data[, -1]
View(data)
install.package(pacman)
install.packages(pacman)
install.packages("pacman")
library(pacman) # install.packages("pacman")
View(TempData)
p_load(tibble, dplyr, magrittr, purrr)
contrasts <- TempData %>%
#  select(generlen, TLOfADRRreal, TLOfADRR1) %>%
#  mutate_if(is.numeric, log2) %>%
map(pic, tree2)
View(contrasts)
cor.test(contrasts$GenerationLength_d, contrasts$FrT, method= 'spearman')  # p = 0.02491, rho = -0.08810244  # PAPER
cor.test(contrasts$GenerationLength_d, contrasts$FrC, method= 'spearman')  # p = 0.02121, rho =  0.09050626  # PAPER
cor.test(contrasts$GenerationLength_d, contrasts$FrA, method= 'spearman')  # p = 0.09415
cor.test(contrasts$GenerationLength_d, contrasts$FrG, method= 'spearman')  # p = 0.06404
View(contrasts)
contrasts2 <- as.data.frame(apply(TempData, 2, pic, tree2))
# contrasts2 <- as.data.frame(apply(TempData, 2, pic, tree2))
names(contrasts2) = names(TempData)
summary(contrasts2$GenerationLength_d)
summary(contrasts$GenerationLength_d)
sumary(pic(TempData$GenerationLength_d, tree2))
summary(pic(TempData$GenerationLength_d, tree2))
summary(pic(TempData$FrA, tree2))
summary(contrasts$FrA)
summary(pic(TempData$GenerationLength_d, tree2)) == summary(contrasts$GenerationLength_d)
cor.test(contrasts$GenerationLength_d, contrasts$FrT, method= 'spearman')  # p = 0.02491, rho = -0.08810244  # PAPER
cor.test(contrasts$GenerationLength_d, contrasts$FrC, method= 'spearman')  # p = 0.02121, rho =  0.09050626  # PAPER
cor.test(contrasts$GenerationLength_d, contrasts$FrA, method= 'spearman')  # p = 0.09415
cor.test(contrasts$GenerationLength_d, contrasts$FrG, method= 'spearman')  # p = 0.06404
### start from pairwise correlations and go to multiple linear model:
cor.test(log2(AGG$GenerationLength_d),AGG$FrA, method = 'spearman') # rho -0.2681362; p = 3.635e-12
cor.test(log2(AGG$GenerationLength_d),AGG$FrT, method = 'spearman') # rho -0.3066279; p = 1.287e-15
cor.test(log2(AGG$GenerationLength_d),AGG$FrG, method = 'spearman') # rho  0.1804395; p = 3.665e-06
cor.test(log2(AGG$GenerationLength_d),AGG$FrC, method = 'spearman') # rho  0.4717114;  p < 2.2e-16
A <- lm(log2(AGG$GenerationLength_d) ~ AGG$FrA + AGG$FrT + AGG$FrC); summary(A) # A is not significant - delete it
A <- lm(log2(AGG$GenerationLength_d) ~ AGG$FrT + AGG$FrC); summary(A)
A <- lm(log2(AGG$GenerationLength_d) ~ scale(AGG$FrT) + scale(AGG$FrC)); summary(A) # log2(GT) = 11.08294 - 0.12 scale(FrT) + 0.45 scale(FrC)
A <- lm(scale(contrasts$GenerationLength_d) ~ contrasts$FrA + contrasts$FrT + contrasts$FrC); summary(A) # A is not significant - delete it
A <- lm(scale(contrasts$GenerationLength_d) ~ contrasts$FrT + contrasts$FrC); summary(A) # only C is significant
A <- lm(scale(contrasts$GenerationLength_d) ~ contrasts$FrC); summary(A) # only C is significant: 0.00596 **
data = AGG[which(as.character(AGG$Species) %in% tree$tip.label),]
TempData = data[, -1]
contrasts <- TempData %>%
#  select(generlen, TLOfADRRreal, TLOfADRR1) %>%
#  mutate_if(is.numeric, log2) %>%
map(pic, tree2)
data = AGG[which(as.character(AGG$Species) %in% tree$tip.label),]
data$GenerationLength_d = log2(data$GenerationLength_d)  # I added log of generation length
data = data[-597,] # It is duplicate
row.names(data) = data$Species
tree2 <- drop.tip(tree, b)
TempData = data[, -1]
contrasts <- TempData %>%
#  select(generlen, TLOfADRRreal, TLOfADRR1) %>%
#  mutate_if(is.numeric, log2) %>%
map(pic, tree2)
summary(pic(TempData$GenerationLength_d, tree2)) == summary(contrasts$GenerationLength_d)
summary(contrasts$GenerationLength_d)
summary(TempData$GenerationLength_d)
summary(pic(TempData$GenerationLength_d, tree2))
A <- lm(scale(contrasts$GenerationLength_d) ~ contrasts$FrA + contrasts$FrT + contrasts$FrC); summary(A) # A is not significant - delete it
summary(pic(TempData$GenerationLength_d, tree2))
summary(contrasts$FrA)
?pic
summary(pic(TempData$GenerationLength_d, tree2, scaled = FALSE))
data = AGG[which(as.character(AGG$Species) %in% tree$tip.label),]
data = data[-597,] # It is duplicate
TempData = data[, -1]
summary(pic(TempData$GenerationLength_d, tree2))
Rep = read.table('../../../ComparativeGenomics/Body/3Results/ecoreps.csv', sep = ';', header = TRUE)
data = Rep[which(as.character(Rep$spece) %in% tree$tip.label),]
row.names(data) = data$spece
df_vec <- as.character(Rep$spece)
tree_vec <- tree$tip.label
a <- setdiff(df_vec, tree_vec)
b <- setdiff(tree_vec, df_vec)
tree2 <- drop.tip(tree, b)
contrasts <- data %>%
select(generlen, TLOfADRRreal, TLOfADRR1) %>%
mutate_if(is.numeric, log2) %>%
map(pic, tree2)
summary(contrasts$generlen)
summary(pic(log2(data$generlen), tree2))
summary(data$generlen)
summary(TempData)
summary(TempData$GenerationLength_d)
contrasts <- TempData %>%
#  select(generlen, TLOfADRRreal, TLOfADRR1) %>%
#  mutate_if(is.numeric, log2) %>%
map(pic, tree2)
data = AGG[which(as.character(AGG$Species) %in% tree$tip.label),]
data$GenerationLength_d = log2(data$GenerationLength_d)  # I added log of generation length
df_vec <- as.character(AGG$Species)
tree_vec <- tree$tip.label
a <- setdiff(df_vec, tree_vec)
b <- setdiff(tree_vec, df_vec)
data = data[-597,] # It is duplicate
row.names(data) = data$Species
tree2 <- drop.tip(tree, b)
TempData = data[, -1]
contrasts <- TempData %>%
#  select(generlen, TLOfADRRreal, TLOfADRR1) %>%
#  mutate_if(is.numeric, log2) %>%
map(pic, tree2)
summary(pic(TempData$GenerationLength_d, tree2))
data = AGG[which(as.character(AGG$Species) %in% tree$tip.label),]
df_vec <- as.character(AGG$Species)
tree_vec <- tree$tip.label
a <- setdiff(df_vec, tree_vec)
b <- setdiff(tree_vec, df_vec)
data = data[-597,] # It is duplicate
row.names(data) = data$Species
tree2 <- drop.tip(tree, b)
TempData = data[, -1]
contrasts <- TempData %>%
#  select(generlen, TLOfADRRreal, TLOfADRR1) %>%
mutate_if(is.numeric, log2) %>%
map(pic, tree2)
summary(contrasts$GenerationLength_d)
summary(pic(TempData$GenerationLength_d, tree2)) == summary(contrasts$GenerationLength_d)
summary(pic(TempData$GenerationLength_d, tree2))
View(contrasts)
summary(log2(pic(TempData$GenerationLength_d, tree2))) == summary(contrasts$GenerationLength_d)
cor.test(contrasts$GenerationLength_d, contrasts$FrT, method= 'spearman')  # p = 0.02491, rho = -0.08810244  # PAPER
View(TempData)
View(contrasts)
length(tree2$tip.label)
summary(log2(pic(TempData$GenerationLength_d, tree2))) == summary(contrasts$GenerationLength_d)
summary(pic(log2(TempData$GenerationLength_d), tree2)) == summary(contrasts$GenerationLength_d)
summary(pic(log2(TempData$GenerationLength_d), tree2))
data = Rep[which(as.character(Rep$spece) %in% tree$tip.label),]
row.names(data) = data$spece
df_vec <- as.character(Rep$spece)
tree_vec <- tree$tip.label
a <- setdiff(df_vec, tree_vec)
b <- setdiff(tree_vec, df_vec)
tree2 <- drop.tip(tree, b)
length(tree2$tip.label)
contrasts <- data %>%
select(generlen, TLOfADRRreal, TLOfADRR1) %>%
mutate_if(is.numeric, log2) %>%
map(pic, tree2)
summary(contrasts$generlen)
summary(pic(log2(data$generlen), tree2))
data = AGG[which(as.character(AGG$Species) %in% tree$tip.label),]
# data$GenerationLength_d = log2(data$GenerationLength_d)  # I added log of generation length
df_vec <- as.character(AGG$Species)
tree_vec <- tree$tip.label
a <- setdiff(df_vec, tree_vec)
b <- setdiff(tree_vec, df_vec)
data = data[-597,] # It is duplicate
row.names(data) = data$Species
tree2 <- drop.tip(tree, b)
TempData = data[, -1]
contrasts <- TempData %>%
#  select(generlen, TLOfADRRreal, TLOfADRR1) %>%
mutate_if(is.numeric, log2) %>%
map(pic, tree2)
summary(pic(log2(TempData$GenerationLength_d), tree2)) == summary(contrasts$GenerationLength_d)
summary(pic(log2(TempData$GenerationLength_d), tree2))
contrasts2 <- as.data.frame(apply(TempData, 2, pic, tree2))
names(contrasts2) = names(TempData)
View(contrasts)
View(contrasts2)
names(data)
contrasts <- data %>%
select(GenerationLength_d, FrA, FrT, FrG, FrC) %>%
mutate_if(is.numeric, log2) %>%
map(pic, tree2)
summary(pic(log2(TempData$GenerationLength_d), tree2)) == summary(contrasts$GenerationLength_d)
summary(pic(log2(TempData$GenerationLength_d), tree2))
summary(TempData$GenerationLength_d)
data = Rep[which(as.character(Rep$spece) %in% tree$tip.label),]
summary(data$generlen)
SynNuc = read.table("../../Body/3Results/AllGenesCodonUsageNoOverlap.txt", header = TRUE, sep = '\t')
############ Syn mut
unzip("../../Body/3Results/AllGenesCodonUsageNoOverlap.txt.zip", exdir = "../../Body/3Results/")
SynNuc = read.table("../../Body/3Results/AllGenesCodonUsageNoOverlap.txt", header = TRUE, sep = '\t')
if (file.exists("../../Body/3Results/AllGenesCodonUsageNoOverlap.txt")) file.remove("../../Body/3Results/AllGenesCodonUsageNoOverlap.txt")
names(SynNuc)
### make ND6 complementary:
NotND6 = SynNuc[SynNuc$Gene != 'ND6',]
ND6 = SynNuc[SynNuc$Gene == 'ND6',]
A = ND6$NeutralT
T = ND6$NeutralA
G = ND6$NeutralC
C = ND6$NeutralG
ND6$NeutralA = A
ND6$NeutralT = T
ND6$NeutralG = G
ND6$NeutralC = C
SynNuc = rbind(NotND6,ND6)
### count fraction of nucleotides
SynNuc$FrA = SynNuc$NeutralA / (SynNuc$NeutralA + SynNuc$NeutralT + SynNuc$NeutralG + SynNuc$NeutralC)
SynNuc$FrT = SynNuc$NeutralT / (SynNuc$NeutralA + SynNuc$NeutralT + SynNuc$NeutralG + SynNuc$NeutralC)
SynNuc$FrG = SynNuc$NeutralG / (SynNuc$NeutralA + SynNuc$NeutralT + SynNuc$NeutralG + SynNuc$NeutralC)
SynNuc$FrC = SynNuc$NeutralC / (SynNuc$NeutralA + SynNuc$NeutralT + SynNuc$NeutralG + SynNuc$NeutralC)
SynNuc$TAXON = SynNuc$Class
VecOfTaxa = unique(SynNuc$TAXON)
GT = read.table("../../Body/1Raw/GenerationLenghtforMammals.xlsx.txt", header = TRUE, sep = '\t')
GT$Species = gsub(' ','_',GT$Scientific_name)
length(unique(GT$Species))
summary(GT$AdultBodyMass_g)     # 2        21        71    136058       614 154321304
summary(GT$GenerationLength_d)  # 129.0   624.4  1101.1  1578.8  2064.3 18980.0 # max = 18980 days => 52 years. ok
GT = GT[,c(11,13)]
summary(GT$GenerationLength_d)
############ merge (work only with mammals since GT is only for mammals)
SynNucGT = merge(GT,SynNuc)
length(unique(SynNucGT$Species))  # 649 species
table(SynNucGT$TAXON)
########### question 1: which nucleotides better correlate with GT: log2(GT) = 11 - 0.29*scale(FrT) + 0.33*scale(FrC) (in line with our mutational spectrum result that T->C correlates with generation time)
AGG = aggregate(list(SynNucGT$FrA,SynNucGT$FrT,SynNucGT$FrG,SynNucGT$FrC), by = list(SynNucGT$Species,SynNucGT$GenerationLength_d), FUN = mean)
library(ape)
library(pacman) # install.packages("pacman")
tree <- read.tree("../../Body/1Raw/mtalign.aln.treefile.rooted")
data = AGG[which(as.character(AGG$Species) %in% tree$tip.label),]
# data$GenerationLength_d = log2(data$GenerationLength_d)  # I added log of generation length
df_vec <- as.character(AGG$Species)
tree_vec <- tree$tip.label
a <- setdiff(df_vec, tree_vec)
b <- setdiff(tree_vec, df_vec)
data = data[-597,] # It is duplicate
row.names(data) = data$Species
tree2 <- drop.tip(tree, b)
View(data)
data = AGG[which(as.character(AGG$Species) %in% tree$tip.label),]
# data$GenerationLength_d = log2(data$GenerationLength_d)  # I added log of generation length
df_vec <- as.character(AGG$Species)
tree_vec <- tree$tip.label
a <- setdiff(df_vec, tree_vec)
b <- setdiff(tree_vec, df_vec)
data = data[-597,] # It is duplicate
row.names(data) = data$Species
tree2 <- drop.tip(tree, b)
data = AGG[which(as.character(AGG$Species) %in% tree$tip.label),]
########### question 1: which nucleotides better correlate with GT: log2(GT) = 11 - 0.29*scale(FrT) + 0.33*scale(FrC) (in line with our mutational spectrum result that T->C correlates with generation time)
AGG = aggregate(list(SynNucGT$FrA,SynNucGT$FrT,SynNucGT$FrG,SynNucGT$FrC), by = list(SynNucGT$Species,SynNucGT$GenerationLength_d), FUN = mean)
names(AGG) = c('Species','GenerationLength_d','FrA','FrT','FrG','FrC')
tree <- read.tree("../../Body/1Raw/mtalign.aln.treefile.rooted")
data = AGG[which(as.character(AGG$Species) %in% tree$tip.label),]
# data$GenerationLength_d = log2(data$GenerationLength_d)  # I added log of generation length
df_vec <- as.character(AGG$Species)
tree_vec <- tree$tip.label
a <- setdiff(df_vec, tree_vec)
b <- setdiff(tree_vec, df_vec)
data = data[-597,] # It is duplicate
row.names(data) = data$Species
tree2 <- drop.tip(tree, b)
TempData = data[, -1]
p_load(tibble, dplyr, magrittr, purrr)
contrasts <- TempData %>%
#  select(GenerationLength_d, FrA, FrT, FrG, FrC) %>%
mutate_if(is.numeric, log2) %>%
map(pic, tree2)
summary(pic(log2(TempData$GenerationLength_d), tree2)) == summary(contrasts$GenerationLength_d)
summary(pic(log2(TempData$GenerationLength_d), tree2))
summary(TempData$GenerationLength_d)
summary(TempData$FrA)
summary(TempData$FrT)
summary(TempData$FrG)
summary(TempData$FrC)
contrasts2 <- as.data.frame(apply(TempData, 2, pic, tree2))
names(contrasts2) = names(TempData)
contrasts2
summary(contrasts2$GenerationLength_d)
pic(log2(TempData$GenerationLength_d), tree2)
summary(pic(log2(TempData$GenerationLength_d), tree2))
summary(pic(TempData$FrA, tree2))
Rep = read.table('../../Body/3Results/ecoreps.csv', sep = ';', header = TRUE)
Rep = read.table('../../../ComparativeGenomics/Body/3Results/ecoreps.csv', sep = ';', header = TRUE)
tree <- read.tree("../../Body/1Raw/mtalign.aln.treefile.rooted")
data = Rep[which(as.character(Rep$spece) %in% tree$tip.label),]
row.names(data) = data$spece
df_vec <- as.character(Rep$spece)
tree_vec <- tree$tip.label
a <- setdiff(df_vec, tree_vec)
b <- setdiff(tree_vec, df_vec)
tree2 <- drop.tip(tree, b)
contrasts <- data %>%
select(generlen, TLOfADRRreal, TLOfADRR1) %>%
mutate_if(is.numeric, log2) %>%
map(pic, tree2)
summary(contrasts$generlen)
AGG = aggregate(list(SynNucGT$FrA,SynNucGT$FrT,SynNucGT$FrG,SynNucGT$FrC), by = list(SynNucGT$Species,SynNucGT$GenerationLength_d), FUN = mean)
names(AGG) = c('Species','GenerationLength_d','FrA','FrT','FrG','FrC')
TempData$GenerationLength_d = log2(TempData$GenerationLength_d)
contrasts2 <- as.data.frame(apply(TempData, 2, pic, tree2))
summary(TempData$GenerationLength_d)
TempData = data[, -1]
data = AGG[which(as.character(AGG$Species) %in% tree$tip.label),]
# data$GenerationLength_d = log2(data$GenerationLength_d)  # I added log of generation length
df_vec <- as.character(AGG$Species)
tree_vec <- tree$tip.label
a <- setdiff(df_vec, tree_vec)
b <- setdiff(tree_vec, df_vec)
data = data[-597,] # It is duplicate
row.names(data) = data$Species
tree2 <- drop.tip(tree, b)
TempData = data[, -1]
TempData$GenerationLength_d = log2(TempData$GenerationLength_d)
contrasts2 <- as.data.frame(apply(TempData, 2, pic, tree2))
names(contrasts2) = names(TempData)
summary(contrasts2$GenerationLength_d)
pic(log2(TempData$GenerationLength_d), tree2)
summary(pic(log2(TempData$GenerationLength_d), tree2))
summary(TempData$GenerationLength_d)
TempData = data[, -1]
summary(TempData$GenerationLength_d)
summary(log2(TempData$GenerationLength_d))
pic(TempData$FrA)
pic(TempData$FrA, tree2)
summary(pic(TempData$FrA, tree2))
summary(pic(log2(TempData$GenerationLength_d), tree2))
summary(pic(log2(TempData$GenerationLength_d), tree2))
summary(pic((TempData$GenerationLength_d), tree2))
View(data)
summary(contrasts$GenerationLength_d)
contrasts <- TempData %>%
#  select(GenerationLength_d, FrA, FrT, FrG, FrC) %>%
mutate_if(is.numeric, log2) %>%
map(pic, tree2)
summary(contrasts$GenerationLength_d)
is.binary(tree2)
data = Rep[which(as.character(Rep$spece) %in% tree$tip.label),]
row.names(data) = data$spece
df_vec <- as.character(Rep$spece)
tree_vec <- tree$tip.label
a <- setdiff(df_vec, tree_vec)
b <- setdiff(tree_vec, df_vec)
tree2 <- drop.tip(tree, b)
summary(tree2)
data = AGG[which(as.character(AGG$Species) %in% tree$tip.label),]
# data$GenerationLength_d = log2(data$GenerationLength_d)  # I added log of generation length
df_vec <- as.character(AGG$Species)
tree_vec <- tree$tip.label
a <- setdiff(df_vec, tree_vec)
b <- setdiff(tree_vec, df_vec)
data = data[-597,] # It is duplicate
row.names(data) = data$Species
tree2 <- drop.tip(tree, b)
TempData = data[, -1]
p_load(tibble, dplyr, magrittr, purrr, skimr)
data = Rep[which(as.character(Rep$spece) %in% tree$tip.label),]
row.names(data) = data$spece
df_vec <- as.character(Rep$spece)
tree_vec <- tree$tip.label
a <- setdiff(df_vec, tree_vec)
b <- setdiff(tree_vec, df_vec)
tree2 <- drop.tip(tree, b)
data %>% skim()
write.table(data, '~/Desktop/TableForPics.txt', sep='\t', quote = FALSE)
a = read.table('~/Desktop/TableForPics.txt', sep='\t', header = TRUE)
View(a)
